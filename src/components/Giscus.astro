---
// Giscus comment component
---

<div class="giscus-wrapper">
  <script src="https://giscus.app/client.js"
    data-repo="ryanrasti/blog"
    data-repo-id="YOUR_REPO_ID"
    data-category="General"
    data-category-id="YOUR_CATEGORY_ID"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>
</div>

<script>
  // Set initial theme
  function setGiscusTheme(theme) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (iframe) {
      iframe.contentWindow.postMessage(
        { giscus: { setConfig: { theme: theme === 'dark' ? 'dark' : 'light' } } },
        'https://giscus.app'
      );
    }
  }

  // Set theme on load
  const savedTheme = localStorage.getItem('theme');
  const currentTheme = savedTheme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  
  // Wait for Giscus to load then set theme
  const observer = new MutationObserver((mutations) => {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (iframe) {
      setGiscusTheme(currentTheme);
      observer.disconnect();
    }
  });
  
  observer.observe(document.querySelector('.giscus-wrapper'), {
    childList: true,
    subtree: true
  });

  // Listen for theme changes
  document.addEventListener('theme-change', (e) => {
    setGiscusTheme(e.detail.theme);
  });
</script>

<style>
  .giscus-wrapper {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border);
  }
</style>